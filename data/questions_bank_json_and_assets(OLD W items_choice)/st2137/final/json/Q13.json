{
  "question_id": null,
  "course": "ST2137",
  "semester": 2510,
  "assessment_type": "midterm",
  "question_no": 13,
  "is_multi": false,
  "question_stem": "This question is to be answered using R.\nThe dataset in taiwan_dataset.csv contains information on housing prices from Taiwan. The dependent variable is price. One of the explanatory variables collected is the number of nearby convenience stores. This information is stored in num_stores column.\nIt is of interest to test if there is a significant price difference when comparing houses with 4 or less convenience stores to houses with strictly more than 4 convenience stores. This test is to be carried out at the 5% level.\nPerform the following test(s), checks, and then summarise your findings:\n\nRemove the outlier in the dataset. It has been found that the outlier is from a special housing class that should not be included in the analysis.\nANOVA F-test for comparing the means of the 11 groups.\nAssess assumptions (use the empirical rule for assessing homogeneity of variances).\nEstimate the contrast comparing the two groups identified in the question.\nReport the CI for the contrast.",
  "question_stem_html": "<div><p> </p>\n<p>This question is to be answered using R.</p>\n<p>The dataset in <code>taiwan_dataset.csv</code> contains information on housing prices from Taiwan. The dependent variable is <code>price</code>. One of the explanatory variables collected is the number of nearby convenience stores. This information is stored in <code>num_stores</code> column.</p>\n<p>It is of interest to test if there is a significant price difference when comparing houses with 4 or less convenience stores to houses with strictly more than 4 convenience stores. This test is to be carried out at the 5% level.</p>\n<p>Perform the following test(s), checks, and then summarise your findings:</p>\n<ol style=\"list-style-type: decimal;\">\n<li>Remove the outlier in the dataset. It has been found that the outlier is from a special housing class that should not be included in the analysis.</li>\n<li>ANOVA F-test for comparing the means of the 11 groups.</li>\n<li>Assess assumptions (use the empirical rule for assessing homogeneity of variances).</li>\n<li>Estimate the contrast comparing the two groups identified in the question.</li>\n<li>Report the CI for the contrast.</li>\n</ol>\n<p><br><br><br></p></div>",
  "version": 1,
  "update_timestamp": "2025-09-17T22:44:01+08:00",
  "question_media": [],
  "items": [
    {
      "part_number": "a",
      "type": "essay",
      "subtype": "open-ended",
      "part_stem": "This question is to be answered using R.\nThe dataset in taiwan_dataset.csv contains information on housing prices from Taiwan. The dependent variable is price. One of the explanatory variables collected is the number of nearby convenience stores. This information is stored in num_stores column.\nIt is of interest to test if there is a significant price difference when comparing houses with 4 or less convenience stores to houses with strictly more than 4 convenience stores. This test is to be carried out at the 5% level.\nPerform the following test(s), checks, and then summarise your findings:\n\nRemove the outlier in the dataset. It has been found that the outlier is from a special housing class that should not be included in the analysis.\nANOVA F-test for comparing the means of the 11 groups.\nAssess assumptions (use the empirical rule for assessing homogeneity of variances).\nEstimate the contrast comparing the two groups identified in the question.\nReport the CI for the contrast.",
      "part_stem_html": "<div><p> </p>\n<p>This question is to be answered using R.</p>\n<p>The dataset in <code>taiwan_dataset.csv</code> contains information on housing prices from Taiwan. The dependent variable is <code>price</code>. One of the explanatory variables collected is the number of nearby convenience stores. This information is stored in <code>num_stores</code> column.</p>\n<p>It is of interest to test if there is a significant price difference when comparing houses with 4 or less convenience stores to houses with strictly more than 4 convenience stores. This test is to be carried out at the 5% level.</p>\n<p>Perform the following test(s), checks, and then summarise your findings:</p>\n<ol style=\"list-style-type: decimal;\">\n<li>Remove the outlier in the dataset. It has been found that the outlier is from a special housing class that should not be included in the analysis.</li>\n<li>ANOVA F-test for comparing the means of the 11 groups.</li>\n<li>Assess assumptions (use the empirical rule for assessing homogeneity of variances).</li>\n<li>Estimate the contrast comparing the two groups identified in the question.</li>\n<li>Report the CI for the contrast.</li>\n</ol>\n<p><br><br><br></p></div>",
      "choices": [
        {
          "choice_id": "Your answer",
          "text": "text_str",
          "text_html": "<p>text_str</p>",
          "is_correct": null,
          "explanation": null
        }
      ],
      "items_media": [],
      "scoring": {
        "points": 1.0
      },
      "feedback": {},
      "shuffle_choices": false,
      "solution": "library(lattice)\ntaiwan_full \n\nplot of chunk unnamed-chunk-2\n\ntaiwan2 \n##              Df Sum Sq Mean Sq F value Pr(>F)    \n## num_stores   10  30378  3037.8   30.73 \naggregate(price ~ num_stores, data = taiwan2, sd)\n##    num_stores     price\n## 1           0 12.033764\n## 2           1 10.066532\n## 3           2  7.683767\n## 4           3  8.203180\n## 5           4  9.008550\n## 6           5  8.692421\n## 7           6 12.943394\n## 8           7  7.977170\n## 9           8  8.966354\n## 10          9 11.706576\n## 11         10  6.326321\nr1 \n\nplot of chunk unnamed-chunk-2\n\nThe F-statistic has a very small p-value. After removing the outlier, the largest standard deviations is not more than twice the smallest. Along with the qqplot of the residuals, we can conclude that the assumptions of the ANOVA are met and proceed to the next step.\nest_coef \n## The 95% CI for the diff. between the two groups is (-18,-14).\n\nlibrary(lattice)\ntaiwan_full \n\nplot of chunk unnamed-chunk-2\n\ntaiwan2 \n##              Df Sum Sq Mean Sq F value Pr(>F)    \n## num_stores   10  30378  3037.8   30.73 \naggregate(price ~ num_stores, data = taiwan2, sd)\n##    num_stores     price\n## 1           0 12.033764\n## 2           1 10.066532\n## 3           2  7.683767\n## 4           3  8.203180\n## 5           4  9.008550\n## 6           5  8.692421\n## 7           6 12.943394\n## 8           7  7.977170\n## 9           8  8.966354\n## 10          9 11.706576\n## 11         10  6.326321\nr1 \n\nplot of chunk unnamed-chunk-2\n\nThe F-statistic has a very small p-value. After removing the outlier, the largest standard deviations is not more than twice the smallest. Along with the qqplot of the residuals, we can conclude that the assumptions of the ANOVA are met and proceed to the next step.\nest_coef \n## The 95% CI for the diff. between the two groups is (-18,-14).\n\nlibrary(lattice)\ntaiwan_full \n\n\n\nplot of chunk unnamed-chunk-2\n\n\ntaiwan2 \n##              Df Sum Sq Mean Sq F value Pr(>F)    \n## num_stores   10  30378  3037.8   30.73 \naggregate(price ~ num_stores, data = taiwan2, sd)\n##    num_stores     price\n## 1           0 12.033764\n## 2           1 10.066532\n## 3           2  7.683767\n## 4           3  8.203180\n## 5           4  9.008550\n## 6           5  8.692421\n## 7           6 12.943394\n## 8           7  7.977170\n## 9           8  8.966354\n## 10          9 11.706576\n## 11         10  6.326321\nr1 \n\n\n\nplot of chunk unnamed-chunk-2\n\n\nThe F-statistic has a very small p-value. After removing the outlier, the\nlargest standard deviations is not more than twice the smallest. Along with the\nqqplot of the residuals, we can conclude that the assumptions of the ANOVA are\nmet and proceed to the next step.\nest_coef \n## The 95% CI for the diff. between the two groups is (-18,-14).",
      "solution_html": "<pre><code>library(lattice)\ntaiwan_full <- read.csv('taiwan_dataset.csv')\n# we can easily tell the outlier from this plot:\nxyplot(price ~ num_stores, data = taiwan_full, type = c('p', 'r'))</code></pre>\n<div class=\"figure\" style=\"text-align: center;\"><img src=\"$IMS-CC-FILEBASE$/assessment_questions/unnamed-chunk-2-1.png?canvas_download=1\" alt=\"plot of chunk unnamed-chunk-2\" loading=\"lazy\">\n<p class=\"caption\">plot of chunk unnamed-chunk-2</p>\n</div>\n<pre><code>taiwan2 <- taiwan_full[-271,]\ntaiwan2$num_stores <- factor(taiwan2$num_stores)\n\n# ANOVA F-test\nanova1 <- aov(price ~ num_stores, data = taiwan2)\nsummary(anova1)</code></pre>\n<pre><code>##              Df Sum Sq Mean Sq F value Pr(>F)    \n## num_stores   10  30378  3037.8   30.73 <2e-16 ***\n## Residuals   402  39745    98.9                   \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>\n<pre><code>aggregate(price ~ num_stores, data = taiwan2, sd)</code></pre>\n<pre><code>##    num_stores     price\n## 1           0 12.033764\n## 2           1 10.066532\n## 3           2  7.683767\n## 4           3  8.203180\n## 5           4  9.008550\n## 6           5  8.692421\n## 7           6 12.943394\n## 8           7  7.977170\n## 9           8  8.966354\n## 10          9 11.706576\n## 11         10  6.326321</code></pre>\n<pre><code>r1 <- residuals(anova1)\nqqnorm(r1, main = \"QQ plot of residuals\")\nqqline(r1)</code></pre>\n<div class=\"figure\" style=\"text-align: center;\"><img src=\"$IMS-CC-FILEBASE$/assessment_questions/unnamed-chunk-2-2.png?canvas_download=1\" alt=\"plot of chunk unnamed-chunk-2\" loading=\"lazy\">\n<p class=\"caption\">plot of chunk unnamed-chunk-2</p>\n</div>\n<p>The F-statistic has a very small p-value. After removing the outlier, the largest standard deviations is not more than twice the smallest. Along with the qqplot of the residuals, we can conclude that the assumptions of the ANOVA are met and proceed to the next step.</p>\n<pre><code>est_coef <- c(0, coef(anova1)[-1])\nc <- c(rep(1/5, 5), rep(-1/6, 6))\nn_vals <- as.vector(table(taiwan2$num_stores))\nL <- sum(c1*est_coef)\n\nsummary_out <- summary(anova1)\nMSW <- summary_out[[1]]$`Mean Sq`[2]\ndf <- summary_out[[1]]$Df[2]\nse1 <- sqrt(MSW * sum( c1^2 / n_vals ) )\n\nq1 <- qt(0.025, df, 0, lower.tail = FALSE)\n\nlower_ci <- L - q1*se1\nupper_ci <- L + q1*se1\ncat(\"The 95% CI for the diff. between the two groups is (\",\n    format(lower_ci, digits = 2), \",\", format(upper_ci, digits = 2), \").\", sep=\"\")</code></pre>\n<pre><code>## The 95% CI for the diff. between the two groups is (-18,-14).</code></pre>\n\n<pre><code>library(lattice)\ntaiwan_full <- read.csv('taiwan_dataset.csv')\n# we can easily tell the outlier from this plot:\nxyplot(price ~ num_stores, data = taiwan_full, type = c('p', 'r'))</code></pre>\n<div class=\"figure\" style=\"text-align: center;\"><img src=\"$IMS-CC-FILEBASE$/assessment_questions/unnamed-chunk-2-1.png?canvas_download=1\" alt=\"plot of chunk unnamed-chunk-2\" loading=\"lazy\">\n<p class=\"caption\">plot of chunk unnamed-chunk-2</p>\n</div>\n<pre><code>taiwan2 <- taiwan_full[-271,]\ntaiwan2$num_stores <- factor(taiwan2$num_stores)\n\n# ANOVA F-test\nanova1 <- aov(price ~ num_stores, data = taiwan2)\nsummary(anova1)</code></pre>\n<pre><code>##              Df Sum Sq Mean Sq F value Pr(>F)    \n## num_stores   10  30378  3037.8   30.73 <2e-16 ***\n## Residuals   402  39745    98.9                   \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>\n<pre><code>aggregate(price ~ num_stores, data = taiwan2, sd)</code></pre>\n<pre><code>##    num_stores     price\n## 1           0 12.033764\n## 2           1 10.066532\n## 3           2  7.683767\n## 4           3  8.203180\n## 5           4  9.008550\n## 6           5  8.692421\n## 7           6 12.943394\n## 8           7  7.977170\n## 9           8  8.966354\n## 10          9 11.706576\n## 11         10  6.326321</code></pre>\n<pre><code>r1 <- residuals(anova1)\nqqnorm(r1, main = \"QQ plot of residuals\")\nqqline(r1)</code></pre>\n<div class=\"figure\" style=\"text-align: center;\"><img src=\"$IMS-CC-FILEBASE$/assessment_questions/unnamed-chunk-2-2.png?canvas_download=1\" alt=\"plot of chunk unnamed-chunk-2\" loading=\"lazy\">\n<p class=\"caption\">plot of chunk unnamed-chunk-2</p>\n</div>\n<p>The F-statistic has a very small p-value. After removing the outlier, the largest standard deviations is not more than twice the smallest. Along with the qqplot of the residuals, we can conclude that the assumptions of the ANOVA are met and proceed to the next step.</p>\n<pre><code>est_coef <- c(0, coef(anova1)[-1])\nc <- c(rep(1/5, 5), rep(-1/6, 6))\nn_vals <- as.vector(table(taiwan2$num_stores))\nL <- sum(c1*est_coef)\n\nsummary_out <- summary(anova1)\nMSW <- summary_out[[1]]$`Mean Sq`[2]\ndf <- summary_out[[1]]$Df[2]\nse1 <- sqrt(MSW * sum( c1^2 / n_vals ) )\n\nq1 <- qt(0.025, df, 0, lower.tail = FALSE)\n\nlower_ci <- L - q1*se1\nupper_ci <- L + q1*se1\ncat(\"The 95% CI for the diff. between the two groups is (\",\n    format(lower_ci, digits = 2), \",\", format(upper_ci, digits = 2), \").\", sep=\"\")</code></pre>\n<pre><code>## The 95% CI for the diff. between the two groups is (-18,-14).</code></pre>\n\n<pre><code>library(lattice)\ntaiwan_full <- read.csv('taiwan_dataset.csv')\n# we can easily tell the outlier from this plot:\nxyplot(price ~ num_stores, data = taiwan_full, type = c('p', 'r'))</code></pre>\n<div class=\"figure\" style=\"text-align: center\">\n<img src=\"$IMS-CC-FILEBASE$/assessment_questions/unnamed-chunk-2-1.png?canvas_download=1\" alt=\"plot of chunk unnamed-chunk-2\" loading=\"lazy\">\n<p class=\"caption\">\nplot of chunk unnamed-chunk-2\n</p>\n</div>\n<pre><code>taiwan2 <- taiwan_full[-271,]\ntaiwan2$num_stores <- factor(taiwan2$num_stores)\n\n# ANOVA F-test\nanova1 <- aov(price ~ num_stores, data = taiwan2)\nsummary(anova1)</code></pre>\n<pre><code>##              Df Sum Sq Mean Sq F value Pr(>F)    \n## num_stores   10  30378  3037.8   30.73 <2e-16 ***\n## Residuals   402  39745    98.9                   \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>\n<pre><code>aggregate(price ~ num_stores, data = taiwan2, sd)</code></pre>\n<pre><code>##    num_stores     price\n## 1           0 12.033764\n## 2           1 10.066532\n## 3           2  7.683767\n## 4           3  8.203180\n## 5           4  9.008550\n## 6           5  8.692421\n## 7           6 12.943394\n## 8           7  7.977170\n## 9           8  8.966354\n## 10          9 11.706576\n## 11         10  6.326321</code></pre>\n<pre><code>r1 <- residuals(anova1)\nqqnorm(r1, main = \"QQ plot of residuals\")\nqqline(r1)</code></pre>\n<div class=\"figure\" style=\"text-align: center\">\n<img src=\"$IMS-CC-FILEBASE$/assessment_questions/unnamed-chunk-2-2.png?canvas_download=1\" alt=\"plot of chunk unnamed-chunk-2\" loading=\"lazy\">\n<p class=\"caption\">\nplot of chunk unnamed-chunk-2\n</p>\n</div>\n<p>The F-statistic has a very small p-value. After removing the outlier, the\nlargest standard deviations is not more than twice the smallest. Along with the\nqqplot of the residuals, we can conclude that the assumptions of the ANOVA are\nmet and proceed to the next step.</p>\n<pre><code>est_coef <- c(0, coef(anova1)[-1])\nc <- c(rep(1/5, 5), rep(-1/6, 6))\nn_vals <- as.vector(table(taiwan2$num_stores))\nL <- sum(c1*est_coef)\n\nsummary_out <- summary(anova1)\nMSW <- summary_out[[1]]$`Mean Sq`[2]\ndf <- summary_out[[1]]$Df[2]\nse1 <- sqrt(MSW * sum( c1^2 / n_vals ) )\n\nq1 <- qt(0.025, df, 0, lower.tail = FALSE)\n\nlower_ci <- L - q1*se1\nupper_ci <- L + q1*se1\ncat(\"The 95% CI for the diff. between the two groups is (\",\n    format(lower_ci, digits = 2), \",\", format(upper_ci, digits = 2), \").\", sep=\"\")</code></pre>\n<pre><code>## The 95% CI for the diff. between the two groups is (-18,-14).</code></pre>",
      "difficulty_level": 1.0,
      "concept_tags": [
        "probability"
      ]
    }
  ]
}